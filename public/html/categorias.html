<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/categorias.css">
    <title>Categorías</title>
    <script>
        // Función que realiza la búsqueda
        function realizarBusqueda() {
            let query = document.getElementById("searchInput").value;
            if (query) {
                alert("Buscando: " + query); // Aquí puedes reemplazar el alert por la lógica de búsqueda que prefieras
            }
        }

        // Detectar cuando se presiona Enter en el campo de búsqueda
        document.addEventListener("DOMContentLoaded", function() {
            let searchInput = document.getElementById("searchInput");
            searchInput.addEventListener("keydown", function(event) {
                if (event.key === "Enter") { // Verificar si la tecla presionada es Enter
                    realizarBusqueda(); // Llamar a la función de búsqueda
                }
            });
        });
    </script>
</head>
<body>
    <header>
        <section class="barra-superior">
            <div class="logo">
                <img src="../img/logoECDA.png" alt="Logo">
            </div>
            <div class="search-bar">
                <input type="text" id="searchInput" placeholder="Buscar...">
                <button onclick="realizarBusqueda()">
                    <img src="../img/buscar.png" alt="Buscar">
                </button>
            </div>
            <div class="icons">
                <a href="categorias.html">
                    <img src="../img/categorias.png" alt="Categorias">
                </a>
                <a href="/Carrito.html">
                    <img src="../img/carrito-de-compras.png" alt="Carrito de Compras">
                </a>
                <a href="/selec_tienda.php">
                    <img src="../img/tienda.png" alt="Tienda">
                <a href="/login.html">
                    <img src="../img/iniciar-sesion.png" alt="Iniciar Sesion">
                </a>    
            </div>
        </section>
    </header>

    <main>
        <section class="principal">
            <section class="titulo">
                <div class="nombre-titulo">
                    <h1>Categorías</h1>
                </div>
            </section>
            <section class="segundo-apartado" id="categorias-container">
                <!-- Aquí se cargarán las categorías desde el servidor -->
            </section>
        </section>
    </main>

    <footer>
        <img src="../img/logoECDA.png" alt="Logo de la empresa" >
        <p>&copy; Derechos Reservados</p>
        <nav>
            <a href="../index.html">Ir al Inicio</a>
        </nav>
    </footer>

    <script>
        async function cargarCategorias() {
            try {
                const response = await fetch('/categorias');
                if (!response.ok) {
                    throw new Error('Error al cargar categorías');
                }
                const categorias = await response.json();

                const container = document.getElementById('categorias-container');
                container.innerHTML = ''; // Limpiar el contenedor

                if (categorias.length > 0) {
                    categorias.forEach(categoria => {
                        const section = document.createElement('section');
                        section.className = 'categorias';
                        section.innerHTML = `
                            <a class='img-categoria' href='#'>
                                <div>
                                    <img src='' alt='Imagen de ${categoria.Descripcion_Categoria}'>
                                </div>
                            </a>
                            <a class='nombre-categoria' href='#'>
                                <div>
                                    <h2>${categoria.Nombre_Categoria}</h2>
                                </div>
                            </a>
                        `;
                        container.appendChild(section);
                    });
                } else {
                    container.innerHTML = '<p>No se encontraron categorías.</p>';
                }
            } catch (error) {
                console.error(error);
                document.getElementById('categorias-container').innerHTML = '<p>Error al cargar categorías.</p>';
            }
        }

        // Cargar categorías al iniciar la página
        cargarCategorias();
    </script>
</body>
</html>
